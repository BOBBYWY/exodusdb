S

DIFFERENT
S



$INSERT GBP,GENERAL.COMMON*COMMON /DIFFERENT/ LAST.RECCOUNT, COMPARE.FILE*IF COMPARE.FILE EQ '' THEN LAST.RECCOUNT = 9999**IF @RECCOUNT LT LAST.RECCOUNT THEN**  FN=''**  CALL MSG('DIFFERENT FROM WHAT FILE','RC',FN,'')*fn='QFILE'OPEN '',FN TO COMPARE.FILE ELSE STOP 'CANNOT OPEN ':FN*ENDLAST.RECCOUNT = @RECCOUNTREAD REC FROM COMPARE.FILE, @ID THEN  IF @RECORD EQ REC THEN @ANS = '' ELSE   IF @ID[1,1]='$' THEN    REC.DATETIME=FIELD2(@RECORD,@FM,-1)    REC.DATETIME=TRIM(FIELD(REC.DATETIME,' ',2,9)):' ':FIELD(REC.DATETIME,' ',1)    REC.DATETIME=ICONV(REC.DATETIME,'DT')    CMP.DATETIME=FIELD2(REC,@FM,-1)    CMP.DATETIME=TRIM(FIELD(CMP.DATETIME,' ',2,9)):' ':FIELD(CMP.DATETIME,' ',1)    CMP.DATETIME=ICONV(CMP.DATETIME,'DT')    IF REC.DATETIME AND CMP.DATETIME ELSE GOTO CHANGED    IF REC.DATETIME EQ CMP.DATETIME THEN GOTO CHANGED    IF REC.DATETIME GT CMP.DATETIME THEN     @ANS='REPLACES'    END ELSE     @ANS='REPLACED'     END   END ELSECHANGED:    @ANS = 'CHANGED'    END   ENDEND ELSE  @ANS = 'NEW REC'END
R
1

















0