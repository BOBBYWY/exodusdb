#!/bin/bash
set -eux

: ================================
: Copy all EXODUS programs to live
: ================================
:

:
: Create a directory for live services binaries
: =============================================
:
: May be used for EXODUS environment variable "EXO_HOME"
:
	mkdir -p $HOME/live

:
: Install the latest version of the neomail script into test
: ==========================================================
:
	rsync -av --whole-file neomail ~/bin

:
: Copy all bin and lib files to live
: ==================================
:
:	MUST use 'whole file' option to ensure that the OS dlopen understands everything has changed
:	otherwise new code may not become active and/or undefined behaviour i.e. crashes etc.

	#rsync -av ~/bin ~/lib ~/inc ~/live
	#rsync -a ~/{bin,lib,inc} ~/live
	#rsync -av --delete ~/{bin,lib} ~/live
	rsync -av --whole-file ~/{bin,lib} ~/live

:
: =============================================================================
: NOTE - You MUST restart all live processes URGENTLY otherwise they will crash
: =============================================================================
:
:
: Finished copying EXOXUS programs to live in $(($SECONDS / 60)) minutes and $(($SECONDS % 60)) seconds.
: =========================================================================
